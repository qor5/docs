<!DOCTYPE html>

<html>
<head>
<title>Building Admin - Editing - My Document</title>

<meta name='description'>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<base href='/docs/'>

<link href='index.css' rel='stylesheet' type='text/css'>

<script type='text/javascript' defer src='index.js'></script>
</head>

<body>
<div id='app' v-cloak>
<div v-init-context:vars='{hideAside: false}' class='flex h-screen'>
<div class='flex-1 flex flex-col overflow-hidden'>
<div class='flex h-full'>
<aside v-show='!vars.hideAside' id='menuScroller' class='flex flex-col w-80 h-full bg-gray-50 border-r border-gray-200 overflow-y-auto'>
<div class='h-12'><search></search></div>

<ul class='px-0 py-3 mx-0 text-base font-normal list-none text-gray-700'>
<li class='m-0'>
<a href='index.html' id='index.html' onclick='window.storeMenuState("index.html")' class='inline-block px-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Introduction</a>
</li>

<li class='cursor-default px-4 py-1 truncate break-words w-64 m-0'>Getting Started</li>

<li class='m-0'>
<a href='getting-started/one-minute-quick-start.html' id='getting-started/one-minute-quick-start.html' onclick='window.storeMenuState("getting-started/one-minute-quick-start.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>1 Minute Quick Start</a>
</li>

<li class='cursor-default px-4 py-1 truncate break-words w-64 m-0'>Building Admin</li>

<li class='m-0'>
<a href='basics/listing.html' id='basics/listing.html' onclick='window.storeMenuState("basics/listing.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Listing</a>
</li>

<li class='m-0'>
<a href='basics/filter.html' id='basics/filter.html' onclick='window.storeMenuState("basics/filter.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Filters</a>
</li>

<li class='m-0'>
<a href='presets-guide/editing-customizations.html' id='presets-guide/editing-customizations.html' onclick='window.storeMenuState("presets-guide/editing-customizations.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-blue-500'>Editing</a>
</li>

<li class='m-0'>
<a href='basics/brand.html' id='basics/brand.html' onclick='window.storeMenuState("basics/brand.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Brand</a>
</li>

<li class='m-0'>
<a href='basics/menu.html' id='basics/menu.html' onclick='window.storeMenuState("basics/menu.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Menu</a>
</li>

<li class='m-0'>
<a href='presets-guide/detail-page-for-complex-object.html' id='presets-guide/detail-page-for-complex-object.html' onclick='window.storeMenuState("presets-guide/detail-page-for-complex-object.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Detailing</a>
</li>

<li class='m-0'>
<a href='presets-guide/permissions.html' id='presets-guide/permissions.html' onclick='window.storeMenuState("presets-guide/permissions.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Permissions</a>
</li>

<li class='m-0'>
<a href='basics/notification-center.html' id='basics/notification-center.html' onclick='window.storeMenuState("basics/notification-center.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Notification Center</a>
</li>

<li class='m-0'>
<a href='basics/shortcut.html' id='basics/shortcut.html' onclick='window.storeMenuState("basics/shortcut.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Keyboard Shortcut</a>
</li>

<li class='cursor-default px-4 py-1 truncate break-words w-64 m-0'>Web Application</li>

<li class='m-0'>
<a href='basics/page-func-and-event-func.html' id='basics/page-func-and-event-func.html' onclick='window.storeMenuState("basics/page-func-and-event-func.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Page Func and Event Func</a>
</li>

<li class='m-0'>
<a href='advanced-functions/the-go-html-builder.html' id='advanced-functions/the-go-html-builder.html' onclick='window.storeMenuState("advanced-functions/the-go-html-builder.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>The Go HTML builder</a>
</li>

<li class='m-0'>
<a href='presets-guide/its-the-whole-house.html' id='presets-guide/its-the-whole-house.html' onclick='window.storeMenuState("presets-guide/its-the-whole-house.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Not just scaffolding, it&#39;s the whole house</a>
</li>

<li class='m-0'>
<a href='vuetify-components/lazy-portals.html' id='vuetify-components/lazy-portals.html' onclick='window.storeMenuState("vuetify-components/lazy-portals.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Lazy Portals</a>
</li>

<li class='m-0'>
<a href='basics/layout-function-and-page-injector.html' id='basics/layout-function-and-page-injector.html' onclick='window.storeMenuState("basics/layout-function-and-page-injector.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Layout Function and Page Injector</a>
</li>

<li class='m-0'>
<a href='basics/switch-pages-with-push-state.html' id='basics/switch-pages-with-push-state.html' onclick='window.storeMenuState("basics/switch-pages-with-push-state.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Switch Pages with Push State</a>
</li>

<li class='m-0'>
<a href='basics/reload-page-with-a-flash.html' id='basics/reload-page-with-a-flash.html' onclick='window.storeMenuState("basics/reload-page-with-a-flash.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Reload Page with a Flash</a>
</li>

<li class='m-0'>
<a href='basics/partial-refresh-with-portal.html' id='basics/partial-refresh-with-portal.html' onclick='window.storeMenuState("basics/partial-refresh-with-portal.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Partial Refresh with Portal</a>
</li>

<li class='m-0'>
<a href='basics/manipulate-page-url-in-event-func.html' id='basics/manipulate-page-url-in-event-func.html' onclick='window.storeMenuState("basics/manipulate-page-url-in-event-func.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Manipulate Page URL in Event Func</a>
</li>

<li class='m-0'>
<a href='basics/summary-of-event-response.html' id='basics/summary-of-event-response.html' onclick='window.storeMenuState("basics/summary-of-event-response.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Summary of Event Response</a>
</li>

<li class='m-0'>
<a href='basics/scope-component.html' id='basics/scope-component.html' onclick='window.storeMenuState("basics/scope-component.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Scope Component</a>
</li>

<li class='m-0'>
<a href='basics/event-handling.html' id='basics/event-handling.html' onclick='window.storeMenuState("basics/event-handling.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Event Handling</a>
</li>

<li class='m-0'>
<a href='basics/form-handling.html' id='basics/form-handling.html' onclick='window.storeMenuState("basics/form-handling.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Form Handling</a>
</li>

<li class='cursor-default px-4 py-1 truncate break-words w-64 m-0'>UI Components</li>

<li class='m-0'>
<a href='vuetify-components/basic-inputs.html' id='vuetify-components/basic-inputs.html' onclick='window.storeMenuState("vuetify-components/basic-inputs.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Basic Inputs</a>
</li>

<li class='m-0'>
<a href='vuetify-components/a-taste-of-using-vuetify-in-go.html' id='vuetify-components/a-taste-of-using-vuetify-in-go.html' onclick='window.storeMenuState("vuetify-components/a-taste-of-using-vuetify-in-go.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>A Taste of using Vuetify in Go</a>
</li>

<li class='m-0'>
<a href='vuetify-components/linkage-select.html' id='vuetify-components/linkage-select.html' onclick='window.storeMenuState("vuetify-components/linkage-select.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Linkage Select</a>
</li>

<li class='m-0'>
<a href='vuetify-components/auto-complete.html' id='vuetify-components/auto-complete.html' onclick='window.storeMenuState("vuetify-components/auto-complete.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Auto Complete</a>
</li>

<li class='m-0'>
<a href='components-guide/composite-new-component-with-go.html' id='components-guide/composite-new-component-with-go.html' onclick='window.storeMenuState("components-guide/composite-new-component-with-go.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Composite new Component With Go</a>
</li>

<li class='m-0'>
<a href='components-guide/integrate-a-heavy-vue-component.html' id='components-guide/integrate-a-heavy-vue-component.html' onclick='window.storeMenuState("components-guide/integrate-a-heavy-vue-component.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>Integrate a heavy Vue Component</a>
</li>

<li class='cursor-default px-4 py-1 truncate break-words w-64 m-0'>Appendix</li>

<li class='m-0'>
<a href='appendix/all-demo-examples.html' id='appendix/all-demo-examples.html' onclick='window.storeMenuState("appendix/all-demo-examples.html")' class='inline-block pl-10 pr-4 py-1 truncate break-words w-64 hover:text-blue-400 text-gray-700'>All Demo Examples</a>
</li>
</ul>
</aside>

<main class='flex flex-col w-full bg-white overflow-x-hidden overflow-y-auto'>
<div id='docContentBox' class='flex flex-row w-full'>
<div class='flex flex-grow flex-col w-2/3'>
<div class='flex flex-row'>
<button @click='vars.hideAside = !vars.hideAside' class='w-12 h-12 p-4'>
<div class='w-4 h-4 fill-current text-gray-300'>
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="16px" height="16px" viewBox="0 0 16 16" version="1.1">
<g id="surface1">
<path style=" stroke:none;fill-rule:nonzero;fill:rgb(0%,0%,0%);fill-opacity:1;" d="M 2 12 L 2 11 L 14 11 L 14 12 Z M 2 8.5 L 2 7.5 L 14 7.5 L 14 8.5 Z M 2 5 L 2 4 L 14 4 L 14 5 Z M 2 5 "/>
</g>
</svg>
</div>
</button>
</div>

<div id='docMainBox' class='px-16 pb-12 pt-4 overflow-auto'>
<h1 class='mb-8'>Editing</h1>

<div class='border-t'><p>Editing an object will be always in a drawer popup. select which fields can edit for each model
by using the <code>.Only</code> func of <code>EditingBuilder</code>, There are different ways to configure the type
of component that is used to do the editing.</p>

<h2 id='configure-field-for-a-single-model'>Configure field for a single model
<a href='#configure-field-for-a-single-model' class='anchor'></a>
</h2>
<p>Use a customized component is as simple as add the extra asset to the preset instance.
And configure the component func on the field:</p>

<highlightjs :language='"go"' :code='"\nfunc PresetsEditingCustomizationDescription(b *presets.Builder) (\n\tcust *presets.ModelBuilder,\n\tcl *presets.ListingBuilder,\n\tce *presets.EditingBuilder,\n\tdb *gorm.DB,\n) {\n\tcust, cl, ce, db = PresetsListingCustomizationBulkActions(b)\n\tb.URIPrefix(PresetsEditingCustomizationDescriptionPath)\n\tb.ExtraAsset(\"/tiptap.js\", \"text/javascript\", tiptap.JSComponentsPack())\n\tb.ExtraAsset(\"/tiptap.css\", \"text/css\", tiptap.CSSComponentsPack())\n\n\tce.Only(\"Name\", \"CompanyID\", \"Description\")\n\n\tce.Field(\"Description\").ComponentFunc(func(obj interface{}, field *presets.FieldContext, ctx *web.EventContext) h.HTMLComponent {\n\t\treturn tiptap.TipTapEditor().\n\t\t\tFieldName(field.Name).\n\t\t\tValue(field.Value(obj).(string))\n\t})\n\treturn\n}\n\nconst PresetsEditingCustomizationDescriptionPath = \"/samples/presets-editing-customization-description\"\n"'></highlightjs>

<div>
<div class='demo'>
<a href='/samples/presets-editing-customization-description/customers' target='_blank'>Check the demo</a>
 | 
<a href='https://github.com/qor5/docs/tree/master/examples/e21_presents/editing.go' target='_blank'>Source on GitHub</a>
</div>
</div>
<ul>
<li>Added the tiptap javascript and css component pack as an extra asset</li>
<li>Configure the description field to use the component func that returns the <code>tiptap.TipTapEditor()</code> component</li>
<li>Set the field name and value of the component</li>
</ul>

<h2 id='configure-field-type-for-all-models'>Configure field type for all models
<a href='#configure-field-type-for-all-models' class='anchor'></a>
</h2>
<p>Set a global field type to component func like the following:</p>

<highlightjs :language='"go"' :code='"\ntype MyFile string\n\ntype Product struct {\n\tID        int\n\tTitle     string\n\tMainImage MyFile\n}\n\nfunc PresetsEditingCustomizationFileType(b *presets.Builder) (\n\tcust *presets.ModelBuilder,\n\tcl *presets.ListingBuilder,\n\tce *presets.EditingBuilder,\n\tdb *gorm.DB,\n) {\n\tcust, cl, ce, db = PresetsEditingCustomizationDescription(b)\n\terr := db.AutoMigrate(\u0026Product{})\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\n\tb.URIPrefix(PresetsEditingCustomizationFileTypePath)\n\tb.FieldDefaults(presets.WRITE).\n\t\tFieldType(MyFile(\"\")).\n\t\tComponentFunc(func(obj interface{}, field *presets.FieldContext, ctx *web.EventContext) h.HTMLComponent {\n\t\t\tval := field.Value(obj).(MyFile)\n\t\t\tvar img h.HTMLComponent\n\t\t\tif len(string(val)) \u003e 0 {\n\t\t\t\timg = h.Img(string(val))\n\t\t\t}\n\t\t\tvar er h.HTMLComponent\n\t\t\tif len(field.Errors) \u003e 0 {\n\t\t\t\ter = h.Div().Text(field.Errors[0]).Style(\"color:red\")\n\t\t\t}\n\t\t\treturn h.Div(\n\t\t\t\timg,\n\t\t\t\ter,\n\t\t\t\th.Input(\"\").Type(\"file\").Attr(web.VFieldName(fmt.Sprintf(\"%s_NewFile\", field.Name))...),\n\t\t\t)\n\t\t}).\n\t\tSetterFunc(func(obj interface{}, field *presets.FieldContext, ctx *web.EventContext) (err error) {\n\t\t\tff, _, _ := ctx.R.FormFile(fmt.Sprintf(\"%s_NewFile\", field.Name))\n\n\t\t\tif ff == nil {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\treq, err := http.NewRequest(\"PUT\", \"https://transfer.sh/myfile.png\", ff)\n\t\t\tif err != nil {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tvar res *http.Response\n\t\t\tres, err = http.DefaultClient.Do(req)\n\t\t\tif err != nil {\n\t\t\t\tpanic(err)\n\t\t\t}\n\t\t\tvar b []byte\n\t\t\tb, err = ioutil.ReadAll(res.Body)\n\t\t\tif err != nil {\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif res.StatusCode == 500 {\n\t\t\t\terr = fmt.Errorf(\"%s\", string(b))\n\t\t\t\treturn\n\t\t\t}\n\t\t\terr = reflectutils.Set(obj, field.Name, MyFile(b))\n\t\t\treturn\n\t\t})\n\n\tmb := b.Model(\u0026Product{})\n\tmb.Editing(\"Title\", \"MainImage\")\n\treturn\n}\n\nconst PresetsEditingCustomizationFileTypePath = \"/samples/presets-editing-customization-file-type\"\n"'></highlightjs>

<div>
<div class='demo'>
<a href='/samples/presets-editing-customization-file-type/products' target='_blank'>Check the demo</a>
 | 
<a href='https://github.com/qor5/docs/tree/master/examples/e21_presents/editing.go' target='_blank'>Source on GitHub</a>
</div>
</div>
<ul>
<li>We define <code>MyFile</code> to actually be a string</li>
<li>We set <code>FieldDefaults</code> for writing, which is the editing drawer popup to be a customized component</li>
<li>The component show an img tag with the string as src if it&#39;s not empty</li>
<li>The component add a file input for user to upload new file</li>
<li>The <code>SetterFunc</code> is called before save the object, it uploads the file to transfer.sh, and get the url back,
then set the value to <code>MainImage</code> field</li>
</ul>

<p>With <code>FieldDefaults</code> we can write libraries that add customized type for different models to reuse. It can take care
of how to display the edit controls, and How to save the object.</p>

<h2 id='validation'>Validation
<a href='#validation' class='anchor'></a>
</h2>
<p>Field level validation and display on field can be added by implement <code>ValidateFunc</code>,
and set the <code>web.ValidationErrors</code> result:</p>

<highlightjs :language='"go"' :code='"\nfunc PresetsEditingCustomizationValidation(b *presets.Builder) (\n\tcust *presets.ModelBuilder,\n\tcl *presets.ListingBuilder,\n\tce *presets.EditingBuilder,\n\tdb *gorm.DB,\n) {\n\tcust, cl, ce, db = PresetsEditingCustomizationDescription(b)\n\tb.URIPrefix(PresetsEditingCustomizationValidationPath)\n\n\tce.ValidateFunc(func(obj interface{}, ctx *web.EventContext) (err web.ValidationErrors) {\n\t\tcus := obj.(*Customer)\n\t\tif len(cus.Name) \u003c 10 {\n\t\t\terr.FieldError(\"Name\", \"name is too short\")\n\t\t}\n\t\treturn\n\t})\n\treturn\n}\n\nconst PresetsEditingCustomizationValidationPath = \"/samples/presets-editing-customization-validation\"\n"'></highlightjs>

<div>
<div class='demo'>
<a href='/samples/presets-editing-customization-validation/customers' target='_blank'>Check the demo</a>
 | 
<a href='https://github.com/qor5/docs/tree/master/examples/e21_presents/editing.go' target='_blank'>Source on GitHub</a>
</div>
</div>
<ul>
<li>We validate the <code>Name</code> of the customer must be longer than 10</li>
<li>If the error happens, If will show below the field</li>
</ul>
</div>
</div>
</div>

<div class='font-medium text-base hidden xl:block text-gray-600 pt-4'>
<div class='sticky top-4 w-52'>On This Page<toc></toc></div>
</div>
</div>
<search-result></search-result></main>
</div>
</div>
</div>
</div>
</body>
</html>
